# ML-04: Membership Inference Attack

Según OWASP, este ataque ocurre cuando un atacante logra descubrir si un dato específico formó parte del conjunto de entrenamiento de un modelo de Machine Learning.  
Para ello se envían múltiples consultas al modelo con distintos datos de prueba, explotando que el modelo suele comportarse de manera diferente frente a datos nuevos en comparación con los que ya conoce.  
Al analizar los niveles de confianza de las predicciones, el atacante puede inferir si un dato proviene del conjunto de entrenamiento original, lo que permite identificar usuarios y/o exponer información sensible.  
Fuente: [OWASP ML-04: Membership Inference Attack](https://owasp.org/www-project-machine-learning-security-top-10/docs/ML04_2023-Membership_Inference_Attack.html)

---

# Caso 1 — ML04: *Membership Inference* en clasificación “Ataque/No ataque”

**ID:** PT-ML04-001
**Tipo:** ATAQUE (hipotético, con datos sintéticos)  
**Vulnerabilidad:** ML04  
**Descripción:** Evaluar si el modelo de la app permite inferir pertenencia de ciertos patrones de tráfico al dataset de entrenamiento, considerando que solo fue entrenado con ataques básicos de redes locales.  

**Entrada:**  
- Conjunto A: patrones de tráfico similares a los de entrenamiento (ataques locales básicos).  
- Conjunto B: patrones de tráfico más complejos, que no forman parte del dataset de entrenamiento.  

**Procedimiento paso a paso:**  
1. Identificar la salida de la app (etiqueta, score de riesgo, top-k, probabilidades).  
2. Preparar el **Conjunto A** con ejemplos similares al dataset de entrenamiento.  
3. Preparar el **Conjunto B** con ejemplos más complejos.  
4. Simular el envío de ambos conjuntos al modelo.  
5. Comparar las respuestas: observar diferencias de confianza y etiquetas.  
6. Analizar si las diferencias permiten inferir qué patrones estuvieron en el entrenamiento.  
7. Concluir el resultado del ataque en base ainferencias 

**Salida Esperada:**  
- **El ataque es válido**: el modelo muestra diferencias de confianza entre A y B, lo que permite inferir si un patrón estuvo en el dataset de entrenamiento.  
- Ejemplo: mayor seguridad en A (ataques básicos conocidos) y baja confianza o respuestas inconsistentes en B (ataques complejos no vistos).  

**Estado:** Pendiente  
**Severidad:** Alta  

---

# Caso 2 — ML04: *Attribute Inference* (fingerprinting del entorno del cliente)

**ID:** PT-ML04-002  
**Tipo:** ATAQUE (hipotético, con datos sintéticos)  
**Vulnerabilidad:** ML04  
**Descripción:** Evaluar si las salidas del modelo permiten inferir atributos internos del entorno del cliente (p. ej., uso de proxy, firma TLS fija, segmentación de red).  

**Entrada:**  
- Escenario X: eventos simulados que incluyen atributos más avanzados (proxy/NAT, huellas TLS modernas).  
- Escenario Y: mismos eventos pero sin esos atributos (más básicos, acordes al dataset original).  

**Procedimiento paso a paso:**  
1. Seleccionar el atributo sensible a evaluar (ej.: proxy/NAT, huella TLS fija, segmentación).  
2. Generar el **Escenario X** con el atributo presente.  
3. Generar el **Escenario Y** sin ese atributo, manteniendo iguales los demás campos.  
4. Simular el envío de ambos escenarios al modelo.  
5. Observar diferencias en las salidas (etiqueta, score de riesgo, top-k).  
6. Analizar si existe un patrón estable que permita inferir la presencia del atributo.  
7. Concluir sobre el ataque en base a los patrones obsersables

**Salida Esperada:**  
- **El ataque es válido**: el modelo reacciona de forma distinta a X y a Y, revelando indirectamente atributos del entorno.  
- Esto ocurre porque el modelo **no fue entrenado con tráfico avanzado**, solo con patrones locales básicos.  

**Estado:** Pendiente  
**Severidad:** Alta  

