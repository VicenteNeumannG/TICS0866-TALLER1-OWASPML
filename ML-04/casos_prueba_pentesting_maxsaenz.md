# Caso 1 — ML04: Membership Inference en clasificación “Ataque/No ataque”

**ID:** PT-ML04-001  
**Tipo:** ATAQUE (hipotético, con datos sintéticos)  
**Vulnerabilidad:** ML04 — Membership Inference Attack  
**Descripción:**  
Evaluar si el modelo de la app permite inferir la pertenencia de ciertos patrones de tráfico al dataset de entrenamiento.  
En este escenario, un atacante no busca exponer datos de clientes (el dataset es público y anonimizado), sino **determinar si sus propias técnicas de ataque ya están representadas en el entrenamiento**. Esto le permite descartar TTPs conocidas (menos efectivas) y priorizar variantes no vistas (más prometedoras para evadir detección).  

**Entrada:**  
- **Conjunto A:** patrones de tráfico similares a los del dataset UNSW-NB15 (ataques básicos de redes locales).  
- **Conjunto B:** patrones más complejos y modernos, no incluidos en UNSW-NB15 (ej. ataques distribuidos, huellas TLS avanzadas).  

**Procedimiento paso a paso:**  
1. Identificar la salida de la app (etiqueta, score de riesgo, top-k, probabilidades).  
2. Preparar el **Conjunto A** con ejemplos básicos similares a UNSW-NB15.  
3. Preparar el **Conjunto B** con ejemplos avanzados no presentes en el dataset.  
4. Simular el envío de ambos conjuntos al modelo.  
5. Comparar las respuestas: observar diferencias de confianza y etiquetas.  
6. Analizar si los patrones del atacante se comportan como A (ya vistos) o como B (no vistos).  
7. Concluir si sus ataques siguen siendo válidos o deben ser actualizados.  

**Salida Esperada:**  
- **El ataque es válido**: el modelo muestra mayor confianza en A (ataques básicos conocidos) y menos confianza en B (ataques avanzados).  
- Para el atacante:  
  - Si su técnica ≈ A → ya entrenada → menos válida (detectada fácilmente).  
  - Si su técnica ≈ B → no entrenada → más válida (mayor probabilidad de evadir).  

**Estado:** Pendiente  
**Severidad:** Media-Alta (no hay riesgo de privacidad de clientes, pero sí de que atacantes usen el sistema como laboratorio para optimizar sus TTPs).  

---

# Caso 2 — ML04: Attribute Inference (fingerprinting del entorno del cliente)

**ID:** PT-ML04-002  
**Tipo:** ATAQUE (hipotético, con datos sintéticos)  
**Vulnerabilidad:** ML04 — Membership/Attribute Inference  
**Descripción:**  
Evaluar si las salidas del modelo permiten inferir atributos internos del entorno de red.  
El riesgo, en este escenario, no está en filtrar información sensible de clientes, sino en que un atacante pueda **probar variantes de contexto de sus ataques (ej. tras un proxy, con huella TLS fija, en redes segmentadas)** y observar cómo responde el modelo. Con esto identifica **qué entornos son menos cubiertos en el dataset** y, por ende, más útiles para evadir detección.  

**Entrada:**  
- **Escenario X:** eventos simulados con atributos avanzados (proxy/NAT, huellas TLS modernas, segmentación de red).  
- **Escenario Y:** mismos eventos sin dichos atributos (básicos, similares a UNSW-NB15).  

**Procedimiento paso a paso:**  
1. Seleccionar el atributo sensible a evaluar (proxy/NAT, huella TLS fija, segmentación).  
2. Generar el **Escenario X** con ese atributo presente.  
3. Generar el **Escenario Y** sin ese atributo, manteniendo iguales los demás campos.  
4. Simular el envío de ambos escenarios al modelo.  
5. Observar diferencias en salidas (etiqueta, score, top-k).  
6. Analizar si X se comporta como un caso ya visto (entrenado) o como uno nuevo (no visto).  
7. Concluir si el atacante puede usar este feedback para ajustar su estrategia.  

**Salida Esperada:**  
- **El ataque es válido**: el modelo reacciona de forma distinta a X y a Y.  
- Para el atacante:  
  - Si X ≈ Y (ya visto) → técnica menos válida.  
  - Si X produce respuestas inestables o de baja confianza → técnica más válida para evadir.  

**Estado:** Pendiente  
**Severidad:** Media-Alta (no afecta datos sensibles de clientes, pero expone **lagunas del modelo** que un adversario puede aprovechar para mejorar sus ataques).  
